<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wapping</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#1e1e2f; --text:#f0f0f0; --accent:#ffcc00;
      --card:#2c2c3e; --ack:#234231; --ack-border:#2ecc71;
      --blue:#3498db; --orange:#e67e22; --green:#28a745; --red:#dc3545; --teal:#17a2b8; --purple:#9b59b6;
      --discord:#5865F2;
    }
    body { background:var(--bg); color:var(--text); font-family:Arial,Helvetica,sans-serif; text-align:center; padding:24px; margin:0; }
    h1 { color:var(--accent); margin:0 0 14px; font-size:40px; }

    /* Row */
    .timer{
      background:var(--card); margin:12px auto; padding:12px 16px; border-radius:12px;
      width:1100px; max-width:95vw; display:flex; align-items:center; gap:14px;
      box-shadow:0 4px 10px rgba(0,0,0,.35); outline:1px solid rgba(255,255,255,.08);
      transition:opacity .15s ease, filter .15s ease;
    }
    .timer.ack{ background:var(--ack); outline-color:var(--ack-border); }
    .left{ display:flex; align-items:center; gap:12px; min-width:0; flex:1; }
    .label{ overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
    .time-pill{
      display:inline-block; background:#0f1122; border:1px solid rgba(255,255,255,.18);
      padding:4px 12px; border-radius:999px; font-weight:800; font-variant-numeric:tabular-nums;
    }
    .right{ margin-left:auto; display:flex; align-items:center; gap:10px; }

    /* When disabled: dim entire row, but keep the toggle vivid & clickable */
    .timer.disabled{ opacity:.45; }
    .timer.disabled .toggle{ opacity:1 !important; filter:none !important; }
    .timer.disabled .toggle:hover{ background:rgba(255,255,255,.08); box-shadow:0 0 0 1px rgba(255,255,255,.16) inset; }

    /* Ghost icon buttons (edit / clock / speaker) */
    .icon-btn{
      background:transparent; border:0; color:#cfd3e6;
      border-radius:12px; padding:8px; line-height:0; cursor:pointer;
      display:inline-grid; place-items:center;
      transition:transform .06s, color .15s, background .15s, box-shadow .15s;
    }
    .icon-btn:hover{ color:#fff; background:rgba(255,255,255,.08); box-shadow:0 0 0 1px rgba(255,255,255,.16) inset; }
    .icon-btn:active{ transform:translateY(1px) scale(.98); }
    /* Normalize all SVG sizes */
    .icon-btn svg, .toggle svg{ width:22px; height:22px; display:block; }

    /* Toggle (UNO skip / green check) */
    .toggle{ padding:6px; border:none; background:transparent; border-radius:12px; line-height:0; cursor:pointer; }
    .toggle.enabled .skip-fill{ fill:#ff5d5d; }       /* red circle */
    .toggle.enabled .skip-stroke{ stroke:#1b0a0a; }
    .toggle.disabled .check-fill{ fill:#2ec97e; }     /* green circle */
    .toggle.disabled .check-stroke{ stroke:#0b1a11; }
    .toggle:hover{ background:rgba(255,255,255,.08); box-shadow:0 0 0 1px rgba(255,255,255,.16) inset; }

    .edit-wrap{ display:none; align-items:center; gap:8px; }
    .edit-input{
      width:520px; max-width:52vw; background:#15172a; color:var(--text);
      border:1px solid rgba(255,255,255,.22); border-radius:8px; padding:8px 10px; font-size:16px;
    }

    /* Controls */
    .controls{ margin:18px 0; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    button.btn{ border:none; border-radius:12px; padding:10px 18px; font-weight:700; cursor:pointer; color:#fff; display:inline-flex; align-items:center; gap:8px; }
    #toggleBtn{ background:var(--blue); } #resetBtn{ background:var(--purple); } #muteBtn{ background:var(--red); }

    /* Presets */
    .preset-bar{ margin:14px auto 6px; width:1100px; max-width:95vw; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    .chip{ background:#2b2e43; border:1px solid rgba(255,255,255,.14); border-radius:12px; display:flex; align-items:center; gap:8px; padding:8px 10px; }
    .chip input{ width:110px; background:transparent; border:none; color:#fff; font-weight:800; text-align:center; }
    .mini{ border:none; background:#384365; color:#fff; border-radius:8px; padding:6px 10px; font-weight:800; cursor:pointer; }
    .mini.view{ background:#2f71d6; } .mini.save{ background:#2d9b56; }

    /* Footer */
    footer{ margin-top:22px; padding-top:14px; border-top:1px solid #444; opacity:.95; font-size:14px; }
    .dogdog{ color:var(--accent); font-weight:700; }
    .discord-block{ margin-top:12px; display:flex; justify-content:center; align-items:center; gap:10px; flex-wrap:wrap; color:#fff; }
    .discord-chip{
      background:var(--card); padding:4px 10px; border-radius:8px; font-weight:700; color:#7289da;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    .svg{ width:20px; height:20px; display:inline-block; vertical-align:middle; }
    .copied-msg{ font-size:12px; color:#2ecc71; font-weight:700; opacity:0; transition:opacity .2s; }

    /* Toast */
    .toast{
      position:fixed; right:16px; bottom:80px; background:#111827; color:#e5e7eb;
      border:1px solid #334155; padding:10px 14px; border-radius:10px; opacity:0; transform:translateY(10px);
      transition:all .18s ease; box-shadow:0 8px 22px rgba(0,0,0,.35);
    }
    .toast.show{ opacity:1; transform:translateY(0); }
  </style>
</head>
<body>
  <h1>Wapping</h1>

  <div id="rows"></div>

  <div class="controls">
    <button id="toggleBtn" class="btn">‚ñ∂Ô∏è Start</button>
    <button id="resetBtn" class="btn">üîÅ Reset</button>
    <button id="muteBtn" class="btn">üîá Mute</button>
  </div>

  <div class="preset-bar" id="presetBar"></div>

  <footer>
    <p style="margin:0 0 8px 0;">
      <strong>üí¨ Got ideas or found a bug?</strong><br>
      Leave feedback for <span class="dogdog">Dogdog</span> ‚Äî help make this better üê∂
    </p>
    <div class="discord-block">
      <!-- Discord logo -->
      <svg class="svg" viewBox="0 0 245 240" aria-hidden="true">
        <path fill="#5865F2" d="M104.4 104.3c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1s-4.6-11.1-10.2-11.1zm36.2 0c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1s-4.6-11.1-10.2-11.1z"/><path fill="#5865F2" d="M189.5 20h-134A35.5 35.5 0 0 0 20 55.5v129A35.5 35.5 0 0 0 55.5 220h93.7l-4.4-15.4 10.6 9.9 10 9.3 17.8 16.1V220h6.3A35.5 35.5 0 0 0 225 184.5v-129A35.5 35.5 0 0 0 189.5 20zm-26.1 135s-2.4-2.9-4.4-5.4c8.6-2.4 11.8-7.6 11.8-7.6-2.7 1.7-5.3 3-7.6 3.9-3.3 1.4-6.6 2.3-9.8 2.9-6.5 1.2-12.4.9-17.5-.1-3.8-.7-7-1.6-9.7-2.9-1.5-.7-3.1-1.5-4.7-2.6-.2-.1-.3-.2-.5-.3-.1-.1-.2-.1-.3-.2-1.4-.8-2.2-1.3-2.2-1.3s3.1 5.1 11.3 7.5c-1.9 2.5-4.4 5.5-4.4 5.5-14.6-.5-20.1-10-20.1-10 0-21.2 9.5-38.4 9.5-38.4 9.5-7.1 18.5-6.9 18.5-6.9l.7.8c-11.9 3.4-17.3 8.6-17.3 8.6s1.5-.8 4-1.9c7.3-3.2 13-4.1 15.3-4.3.4-.1.8-.1 1.2-.1 4.3-.5 9.3-.6 14.5-.1 6.8.8 14 2.9 21.4 7.2 0 0-5.2-5-16.4-8.4l1-1.1s9-.2 18.5 6.9c0 0 9.5 17.2 9.5 38.4 0 0-5.5 9.4-20.2 10z"/>
      </svg>
      <span>Discord:</span>
      <code class="discord-chip" id="discordTag">dogtooth.7</code>
      <!-- Stacked-sheets copy -->
      <button class="icon-btn" id="copyDiscord" title="Copy to clipboard" aria-label="Copy to clipboard">
        <svg class="svg" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor" d="M16 1H6a2 2 0 0 0-2 2v10h2V3h10V1z"/>
          <path fill="currentColor" d="M18 5H10a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 16H10V7h8v14z"/>
        </svg>
      </button>
      <span id="copiedMsg" class="copied-msg">Copied!</span>
    </div>
  </footer>

  <div id="toast" class="toast">‚úÖ Saved</div>

<script>
/* ===== DEFAULT REMINDERS ===== */
const DEFAULT_ITEMS = [
  { text:'Use phalanx u fucken dog', secs:30,   enabled:true },
  { text:'Loot ur mesos and use erda fountain u fucken dog', secs:55, enabled:true },
  { text:'Pop ur fucken EXP multipliers or ur a dog', secs:1800, enabled:true },
  { text:'If ur a true blue fair dinkum aussie, ud pop a VB longneck wap u fucken dog cunts', secs:7200, enabled:true }
];

const STORAGE_KEY='tpl2_items_v6';
const PRESET_KEYS=['tpl2_preset_1','tpl2_preset_2','tpl2_preset_3'];
const PRESET_NAME_KEY='tpl2_preset_names_v1';

let items = loadItems();
let counters = items.map(i=>i.secs);
let timerId=null, isRunning=false, isPaused=false, muted=false, femaleVoice=null;

function loadItems(){ try{ const j=localStorage.getItem(STORAGE_KEY); if(j) return JSON.parse(j);}catch{} return structuredClone(DEFAULT_ITEMS); }
function saveItems(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(items)); }catch{} }

function sayText(str){ return String(str).replace(/\bexp\b/gi,'E X P'); }

/* ===== PRESETS ===== */
function getPresetNames(){ try{ const j=localStorage.getItem(PRESET_NAME_KEY); if(j) return JSON.parse(j);}catch{} return ['Preset 1','Preset 2','Preset 3']; }
function setPresetName(i,name){ const n=getPresetNames(); n[i]=name||n[i]; localStorage.setItem(PRESET_NAME_KEY, JSON.stringify(n)); renderPresetBar(); }
function loadPresetSlot(i){ try{ const j=localStorage.getItem(PRESET_KEYS[i]); if(!j) return null; const arr=JSON.parse(j); if(!Array.isArray(arr)) return null; return arr.map(x=>({text:String(x.text||''), secs:Math.max(1,parseInt(x.secs)||60), enabled:x.enabled!==false})); }catch{ return null; } }
function savePresetSlot(i,data){ localStorage.setItem(PRESET_KEYS[i], JSON.stringify(data)); }

/* ===== ICON SVGs ===== */
const SVG = {
  pencil: `<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#ff9156" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/><path fill="#ffb98b" d="M20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/></svg>`,
  /* Restored stopwatch: purple body + red hand */
  clock:  `<svg viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="13" r="8" fill="#6b4ea3"/>
            <path d="M8 2h8" stroke="#6b4ea3" stroke-width="2" stroke-linecap="round"/>
            <rect x="10" y="1" width="4" height="3" rx="1" fill="#6b4ea3"/>
            <circle cx="12" cy="13" r="6.5" fill="#f3eaff"/>
            <circle cx="12" cy="13" r="5.5" fill="#ffffff"/>
            <path d="M12 13 L17 10" stroke="#e63946" stroke-width="2.6" stroke-linecap="round"/>
            <circle cx="12" cy="13" r="1.2" fill="#6b4ea3"/>
          </svg>`,
  speaker:`<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="#cfd8ff" d="M5 9h3l4-4v14l-4-4H5z"/><path fill="#6fc1ff" d="M16.5 12a3.5 3.5 0 0 0-2.5-3.346v6.692A3.5 3.5 0 0 0 16.5 12z"/><path fill="#6fc1ff" d="M18.5 12a5.5 5.5 0 0 0-3.5-5.132v2.084A3.5 3.5 0 0 1 17 12a3.5 3.5 0 0 1-2 3.048v2.084A5.5 5.5 0 0 0 18.5 12z"/></svg>`,
  skip:   `<svg viewBox="0 0 32 32" aria-hidden="true"><circle class="skip-fill" cx="16" cy="16" r="14" /><line class="skip-stroke" x1="9" y1="23" x2="23" y2="9" stroke-width="3.6" stroke-linecap="round" /></svg>`,
  check:  `<svg viewBox="0 0 32 32" aria-hidden="true"><circle class="check-fill" cx="16" cy="16" r="14" /><path class="check-stroke" d="M8 17 L14 23 L24 11" stroke-width="3.6" stroke-linecap="round" fill="none"/></svg>`
};

/* ===== RENDER PRESETS BAR ===== */
function renderPresetBar(){
  const bar=document.getElementById('presetBar'); bar.innerHTML='';
  const names=getPresetNames();
  names.forEach((nm,idx)=>{
    const chip=document.createElement('span');
    chip.className='chip';
    chip.innerHTML=`<input value="${nm}" data-rename="${idx}"/><button class="mini view" data-view="${idx}">View</button><button class="mini save" data-save="${idx}">Save</button>`;
    bar.appendChild(chip);
  });
  bar.querySelectorAll('[data-view]').forEach(b=>b.addEventListener('click',()=>{
    const i=Number(b.dataset.view); const arr=loadPresetSlot(i);
    if(!arr){ alert('No set saved here yet.'); return; }
    items=arr; counters=items.map(x=>x.secs); saveItems(); renderRows(); showToast('‚¨áÔ∏è Loaded');
  }));
  bar.querySelectorAll('[data-save]').forEach(b=>b.addEventListener('click',()=>{
    const i=Number(b.dataset.save); savePresetSlot(i,items); showToast('üíæ Saved');
  }));
  bar.querySelectorAll('[data-rename]').forEach(inp=>inp.addEventListener('change',()=>{
    const i=Number(inp.dataset.rename); setPresetName(i, inp.value.trim()||('Preset '+(i+1)));
  }));
}

/* ===== ROWS ===== */
const rowsDiv=document.getElementById('rows');

function renderRows(){
  rowsDiv.innerHTML='';
  items.forEach((it,i)=>{
    const row=document.createElement('div');
    row.className='timer'+(it.enabled?'':' disabled');
    row.id=`row${i}`;
    row.innerHTML=`
      <div class="left">
        <span class="time-pill" title="Edit time with ‚è±"><span id="time${i}">${formatInitial(it.secs)}</span></span>
        <span id="label${i}" class="label">${escapeHtml(it.text)}</span>
        <span id="editWrap${i}" class="edit-wrap">
          <input id="input${i}" class="edit-input" type="text" value="${escapeHtml(it.text)}" />
          <button class="icon-btn" data-save="${i}" title="Save">‚úÖ</button>
          <button class="icon-btn" data-cancel="${i}" title="Cancel">‚úñÔ∏è</button>
        </span>
      </div>
      <div class="right">
        <span class="mute-icons">
          <button class="icon-btn" data-edit="${i}" title="Edit text">${SVG.pencil}</button>
          <button class="icon-btn" data-time="${i}" title="Edit time">${SVG.clock}</button>
          <button class="icon-btn" data-test="${i}" title="Test voice">${SVG.speaker}</button>
        </span>
        <button class="toggle ${it.enabled?'enabled':'disabled'}" data-toggle="${i}" title="${it.enabled?'Disable':'Enable'}">
          ${it.enabled? SVG.skip : SVG.check}
        </button>
      </div>`;
    rowsDiv.appendChild(row);
  });
  attachRowEvents(); paint(true);
}

function escapeHtml(s){ return String(s).replace(/[&<>"]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

function attachRowEvents(){
  rowsDiv.querySelectorAll('[data-edit]').forEach(b=>b.addEventListener('click',()=>{ const i=b.dataset.edit; if(!items[i].enabled) return; openEditor(i); }));
  rowsDiv.querySelectorAll('[data-save]').forEach(b=>b.addEventListener('click',()=>saveEditor(b.dataset.save)));
  rowsDiv.querySelectorAll('[data-cancel]').forEach(b=>b.addEventListener('click',()=>closeEditor(b.dataset.cancel,true)));
  rowsDiv.querySelectorAll('[data-time]').forEach(b=>b.addEventListener('click',()=>{ const i=b.dataset.time; if(!items[i].enabled) return; editTime(i); }));
  rowsDiv.querySelectorAll('[data-test]').forEach(b=>b.addEventListener('click',()=>{ const i=b.dataset.test; if(!items[i].enabled) return; speak(items[i].text, i); }));
  rowsDiv.querySelectorAll('.edit-input').forEach(inp=>inp.addEventListener('keydown',e=>{ if(e.key==='Enter'){ const i=e.target.id.match(/(\d+)/)[0]; saveEditor(i);} }));
  rowsDiv.querySelectorAll('[data-toggle]').forEach(b=>b.addEventListener('click',()=>toggleReminder(Number(b.dataset.toggle))));
}

function openEditor(i){
  const wrap=document.getElementById('editWrap'+i);
  const label=document.getElementById('label'+i);
  wrap.style.display='inline-flex'; label.style.display='none';
  const input=document.getElementById('input'+i); input.focus(); input.select();
}
function closeEditor(i,cancel){
  const wrap=document.getElementById('editWrap'+i);
  const label=document.getElementById('label'+i);
  wrap.style.display='none'; label.style.display='inline';
  if(cancel){ document.getElementById('input'+i).value=items[i].text; }
}
function saveEditor(i){
  const input=document.getElementById('input'+i);
  const val=input.value.trim(); if(!val) return closeEditor(i,true);
  items[i].text=val; document.getElementById('label'+i).textContent=val;
  saveItems(); showToast('‚úÖ Saved'); closeEditor(i,false);
}

function editTime(i){
  const cur=items[i].secs; const promptVal = cur<60 ? String(cur) : hms(cur);
  const input=prompt('Enter time (seconds or h:mm:ss):', promptVal); if(input==null) return;
  const secs=parseTime(input);
  if(!isNaN(secs)&&secs>0){ items[i].secs=secs; counters[i]=secs; saveItems(); paint(false); showToast('‚úÖ Time updated'); }
  else alert('Invalid time. Use seconds or h:mm:ss');
}

function toggleReminder(i){
  items[i].enabled = !items[i].enabled;
  saveItems(); renderRows();
}

/* ===== VOICE ===== */
function pickVoice(){
  const want=[
    "Microsoft Aria Online (Natural)","Microsoft Jenny Online (Natural)","Microsoft Sonia Online (Natural)","Microsoft Natasha Online (Natural)",
    "Google UK English Female","Google US English","Google UK English Male","Samantha","Karen","Tessa"
  ];
  const vs=speechSynthesis.getVoices();
  const sc=vs.map(v=>{
    let s=0; const n=(v.name+" "+(v.voiceURI||"")).toLowerCase();
    if(/english|en-/.test(v.lang||"")) s+=2;
    if(/female/.test(n)) s+=2;
    if(/natural|neural|google/.test(n)) s+=3;
    if(/(en-au|en-gb)/.test((v.lang||"").toLowerCase())) s+=2;
    if(want.some(w=>v.name.indexOf(w)!==-1)) s+=5;
    return {v,s};
  }).sort((a,b)=>b.s-a.s);
  femaleVoice = sc.length? sc[0].v : (vs[0]||null);
}
speechSynthesis.onvoiceschanged = pickVoice; pickVoice();

function speak(msg, idx){
  if (muted) return;
  const u=new SpeechSynthesisUtterance(sayText(msg));
  if (femaleVoice) u.voice=femaleVoice;
  u.lang=(femaleVoice&&femaleVoice.lang)||'en-AU'; u.rate=.95; u.pitch=1.12; u.volume=1;
  const row=document.getElementById(`row${idx}`); if(row) row.classList.add('ack');
  u.onend=()=>{ if(row) row.classList.remove('ack'); };
  speechSynthesis.cancel(); speechSynthesis.speak(u);
}

/* ===== TIME HELPERS ===== */
function hms(sec){ const h=String(Math.floor(sec/3600)).padStart(2,'0'); const m=String(Math.floor((sec%3600)/60)).padStart(2,'0'); const s=String(sec%60).padStart(2,'0'); return `${h}:${m}:${s}`; }
function parseTime(val){
  const s=String(val).trim(); if(/^\d+$/.test(s)) return parseInt(s,10);
  const m=s.match(/^(\d{1,2}):(\d{1,2})(?::(\d{1,2}))?$/);
  if(m){ let hh=parseInt(m[1]||'0',10); let mm=parseInt(m[2]||'0',10); let ss=parseInt(m[3]||'0',10); return hh*3600+mm*60+ss; }
  return NaN;
}
function formatInitial(sec){ return sec<60? `${sec}s` : hms(sec); }

function paint(initial=false){
  items.forEach((it,i)=>{
    const el=document.getElementById(`time${i}`);
    el.textContent = initial ? formatInitial(it.secs) : (it.secs<60? `${counters[i]}s` : hms(counters[i]));
  });
}

function startTicking(){
  if (timerId) return;
  timerId=setInterval(()=>{
    items.forEach((it,i)=>{
      if(!it.enabled) return;
      counters[i]--;
      if(counters[i]<=0){ speak(items[i].text, i); counters[i]=it.secs; }
    });
    paint(false);
  },1000);
}
function stopTicking(){ clearInterval(timerId); timerId=null; }

/* Top controls */
const toggleBtn=document.getElementById('toggleBtn');
const resetBtn=document.getElementById('resetBtn');
const muteBtn=document.getElementById('muteBtn');

toggleBtn.onclick=()=>{
  if(!isRunning){
    isRunning=true; isPaused=false; paint(false); startTicking();
    toggleBtn.textContent='‚è∏Ô∏è Pause'; toggleBtn.style.background='var(--orange)';
  } else if(!isPaused){
    isPaused=true; stopTicking();
    toggleBtn.textContent='‚ñ∂Ô∏è Resume'; toggleBtn.style.background='var(--green)';
  } else {
    isPaused=false; startTicking();
    toggleBtn.textContent='‚è∏Ô∏è Pause'; toggleBtn.style.background='var(--orange)';
  }
};
resetBtn.onclick=()=>{
  stopTicking(); counters=items.map(i=>i.secs); isRunning=false; isPaused=false;
  toggleBtn.textContent='‚ñ∂Ô∏è Start'; toggleBtn.style.background='var(--blue)'; paint(true);
};
muteBtn.onclick=()=>{
  muted=!muted;
  if(muted){ muteBtn.textContent='üîä Unmute'; muteBtn.style.background='var(--teal)'; }
  else { muteBtn.textContent='üîá Mute'; muteBtn.style.background='var(--red)'; }
};

function showToast(txt){ const t=document.getElementById('toast'); t.textContent=txt; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1100); }

/* Copy Discord tag */
(function setupCopy(){
  const btn=document.getElementById('copyDiscord'); if(!btn) return;
  btn.addEventListener('click', async ()=>{
    const text='dogtooth.7';
    try{
      if(navigator.clipboard && window.isSecureContext){ await navigator.clipboard.writeText(text); }
      else { const ta=document.createElement('textarea'); ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); }
      const msg=document.getElementById('copiedMsg'); if(msg){ msg.style.opacity='1'; setTimeout(()=>msg.style.opacity='0', 1200); }
    }catch{}
  });
})();

/* First render */
renderPresetBar();
renderRows();
</script>
</body>
</html>